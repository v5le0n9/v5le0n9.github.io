<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=2">
<meta name="theme-color" content="#222">
<meta name="generator" content="Hexo 6.1.0">
  <link rel="apple-touch-icon" sizes="180x180" href="/images/logo.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon32.ico">
  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon16.ico">

<link rel="stylesheet" href="/css/main.css">


<link rel="stylesheet" href="/lib/font-awesome/css/all.min.css">
  <link rel="stylesheet" href="/lib/pace/pace-theme-minimal.min.css">
  <script src="/lib/pace/pace.min.js"></script>

<script id="hexo-configurations">
    var NexT = window.NexT || {};
    var CONFIG = {"hostname":"example.com","root":"/","scheme":"Gemini","version":"7.8.0","exturl":false,"sidebar":{"position":"right","display":"post","padding":18,"offset":12,"onmobile":false},"copycode":{"enable":true,"show_result":true,"style":"default"},"back2top":{"enable":true,"sidebar":true,"scrollpercent":true},"bookmark":{"enable":true,"color":"#222","save":"auto"},"fancybox":false,"mediumzoom":false,"lazyload":false,"pangu":false,"comments":{"style":"tabs","active":"gitalk","storage":true,"lazyload":false,"nav":{"gitalk":{"order":-2}},"activeClass":"gitalk"},"algolia":{"hits":{"per_page":10},"labels":{"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}},"localsearch":{"enable":true,"trigger":"auto","top_n_per_article":-1,"unescape":false,"preload":true},"motion":{"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}},"path":"content.json"};
  </script>

  <meta name="description" content="åœ¨åšç¬¬äº”å…­è¯¾çš„æ‰“è¡¥ä¸ä½œä¸šæ—¶ï¼Œé‡åˆ°äº†åœ¨ä¸è„±å£³çš„æƒ…å†µä¸‹ä¿®æ”¹ç¨‹åºã€‚åœ¨å¤åˆ¶åˆ°å¯æ‰§è¡Œæ–‡ä»¶æ—¶æç¤ºâ€œæ— æ³•å®šä½æ•°æ®â€ã€‚è¿™æ˜¯å› ä¸ºç¨‹åºåŠ å£³åï¼Œä»£ç æ®µæ˜¾ç¤ºå…¨æ˜¯ç©ºä»£ç ï¼Œæˆ‘ä»¬ä¿®æ”¹ä»£ç æ—¶ï¼Œç³»ç»Ÿæ‰§è¡Œå°†æŸä»£ç 1ä¿®æ”¹ä¸ºæŸä»£ç 2ï¼Œä½†ç³»ç»Ÿåœ¨ä»£ç æ®µæ‰¾ä¸åˆ°æŸä»£ç 1ï¼Œæ‰€ä»¥æç¤ºâ€œæ— æ³•å®šä½æ•°æ®â€ã€‚ ä½†å¦‚æœæˆ‘ä»¬å°†ç¨‹åºè„±å£³äº†ï¼Œå°±å¯åœ¨ç¨‹åºä¸Šéšæ„ä¿®æ”¹ï¼Œæ‰€ä»¥è„±å£³çš„é‡è¦æ€§å°±ä½“ç°å‡ºæ¥äº†ã€‚è„±å£³æ¯ä¸€ç”Ÿï¼Œç ´è§£ç©·ä¸‰ä»£(bushi)ã€‚">
<meta property="og:type" content="article">
<meta property="og:title" content="ç¬¬å…«ä¹è¯¾â€”â€”æ·±å…¥æµ…å‡ºæ¢è®¨è„±å£³ç»†èŠ‚">
<meta property="og:url" content="http://example.com/posts/4b9d65e0.html">
<meta property="og:site_name" content="v5le0n9&#39;s garden">
<meta property="og:description" content="åœ¨åšç¬¬äº”å…­è¯¾çš„æ‰“è¡¥ä¸ä½œä¸šæ—¶ï¼Œé‡åˆ°äº†åœ¨ä¸è„±å£³çš„æƒ…å†µä¸‹ä¿®æ”¹ç¨‹åºã€‚åœ¨å¤åˆ¶åˆ°å¯æ‰§è¡Œæ–‡ä»¶æ—¶æç¤ºâ€œæ— æ³•å®šä½æ•°æ®â€ã€‚è¿™æ˜¯å› ä¸ºç¨‹åºåŠ å£³åï¼Œä»£ç æ®µæ˜¾ç¤ºå…¨æ˜¯ç©ºä»£ç ï¼Œæˆ‘ä»¬ä¿®æ”¹ä»£ç æ—¶ï¼Œç³»ç»Ÿæ‰§è¡Œå°†æŸä»£ç 1ä¿®æ”¹ä¸ºæŸä»£ç 2ï¼Œä½†ç³»ç»Ÿåœ¨ä»£ç æ®µæ‰¾ä¸åˆ°æŸä»£ç 1ï¼Œæ‰€ä»¥æç¤ºâ€œæ— æ³•å®šä½æ•°æ®â€ã€‚ ä½†å¦‚æœæˆ‘ä»¬å°†ç¨‹åºè„±å£³äº†ï¼Œå°±å¯åœ¨ç¨‹åºä¸Šéšæ„ä¿®æ”¹ï¼Œæ‰€ä»¥è„±å£³çš„é‡è¦æ€§å°±ä½“ç°å‡ºæ¥äº†ã€‚è„±å£³æ¯ä¸€ç”Ÿï¼Œç ´è§£ç©·ä¸‰ä»£(bushi)ã€‚">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="http://example.com/posts/4b9d65e0/%E8%BD%BD%E5%85%A5%E8%84%9A%E6%9C%AC.png">
<meta property="og:image" content="http://example.com/posts/4b9d65e0/%E8%84%9A%E6%9C%AC%E5%BC%B9%E7%AA%97.png">
<meta property="og:image" content="http://example.com/posts/4b9d65e0/%E8%84%9A%E6%9C%AC%E7%BB%93%E6%9D%9F.png">
<meta property="og:image" content="http://example.com/posts/4b9d65e0/%E6%89%BEIAT.png">
<meta property="article:published_time" content="2022-04-05T01:29:28.142Z">
<meta property="article:modified_time" content="2022-04-11T05:25:50.176Z">
<meta property="article:author" content="v5le0n9">
<meta property="article:tag" content="OllyDbg">
<meta property="article:tag" content="å¾çˆ±ç ´è§£åŸ¹è®­">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="http://example.com/posts/4b9d65e0/%E8%BD%BD%E5%85%A5%E8%84%9A%E6%9C%AC.png">

<link rel="canonical" href="http://example.com/posts/4b9d65e0.html">


<script id="page-configurations">
  // https://hexo.io/docs/variables.html
  CONFIG.page = {
    sidebar: "",
    isHome : false,
    isPost : true,
    lang   : 'zh-CN'
  };
</script>

  <title>ç¬¬å…«ä¹è¯¾â€”â€”æ·±å…¥æµ…å‡ºæ¢è®¨è„±å£³ç»†èŠ‚ | v5le0n9's garden</title>
  






  <noscript>
  <style>
  .use-motion .brand,
  .use-motion .menu-item,
  .sidebar-inner,
  .use-motion .post-block,
  .use-motion .pagination,
  .use-motion .comments,
  .use-motion .post-header,
  .use-motion .post-body,
  .use-motion .collection-header { opacity: initial; }

  .use-motion .site-title,
  .use-motion .site-subtitle {
    opacity: initial;
    top: initial;
  }

  .use-motion .logo-line-before i { left: initial; }
  .use-motion .logo-line-after i { right: initial; }
  </style>
</noscript>

<link rel="alternate" href="/atom.xml" title="v5le0n9's garden" type="application/atom+xml">
</head>

<body itemscope itemtype="http://schema.org/WebPage">
  <div class="container use-motion">
    <div class="headband"></div>

    <header class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-container">
  <div class="site-nav-toggle">
    <div class="toggle" aria-label="åˆ‡æ¢å¯¼èˆªæ ">
      <span class="toggle-line toggle-line-first"></span>
      <span class="toggle-line toggle-line-middle"></span>
      <span class="toggle-line toggle-line-last"></span>
    </div>
  </div>

  <div class="site-meta">

    <a href="/" class="brand" rel="start">
      <span class="logo-line-before"><i></i></span>
      <h1 class="site-title">v5le0n9's garden</h1>
      <span class="logo-line-after"><i></i></span>
    </a>
      <p class="site-subtitle" itemprop="description">å°å‡‰çš„ç§˜å¯†åŸºåœ°</p>
  </div>

  <div class="site-nav-right">
    <div class="toggle popup-trigger">
        <i class="fa fa-search fa-fw fa-lg"></i>
    </div>
  </div>
</div>




<nav class="site-nav">
  <ul id="menu" class="main-menu menu">
        <li class="menu-item menu-item-home">

    <a href="/" rel="section"><i class="fa fa-home fa-fw"></i>é¦–é¡µ</a>

  </li>
        <li class="menu-item menu-item-tags">

    <a href="/tags/" rel="section"><i class="fa fa-tags fa-fw"></i>æ ‡ç­¾</a>

  </li>
        <li class="menu-item menu-item-categories">

    <a href="/categories/" rel="section"><i class="fa fa-th fa-fw"></i>åˆ†ç±»</a>

  </li>
        <li class="menu-item menu-item-archives">

    <a href="/archives/" rel="section"><i class="fa fa-archive fa-fw"></i>å½’æ¡£</a>

  </li>
      <li class="menu-item menu-item-search">
        <a role="button" class="popup-trigger"><i class="fa fa-search fa-fw"></i>æœç´¢
        </a>
      </li>
  </ul>
</nav>



  <div class="search-pop-overlay">
    <div class="popup search-popup">
        <div class="search-header">
  <span class="search-icon">
    <i class="fa fa-search"></i>
  </span>
  <div class="search-input-container">
    <input autocomplete="off" autocapitalize="off"
           placeholder="æœç´¢..." spellcheck="false"
           type="search" class="search-input">
  </div>
  <span class="popup-btn-close">
    <i class="fa fa-times-circle"></i>
  </span>
</div>
<div id="search-result">
  <div id="no-result">
    <i class="fa fa-spinner fa-pulse fa-5x fa-fw"></i>
  </div>
</div>

    </div>
  </div>

</div>
    </header>

    
  <a role="button" class="book-mark-link book-mark-link-fixed"></a>

  <a href="https://github.com/v5le0n9" class="github-corner" title="Follow me on GitHub" aria-label="Follow me on GitHub" rel="noopener" target="_blank"><svg width="80" height="80" viewBox="0 0 250 250" aria-hidden="true"><path d="M0,0 L115,115 L130,115 L142,142 L250,250 L250,0 Z"></path><path d="M128.3,109.0 C113.8,99.7 119.0,89.6 119.0,89.6 C122.0,82.7 120.5,78.6 120.5,78.6 C119.2,72.0 123.4,76.3 123.4,76.3 C127.3,80.9 125.5,87.3 125.5,87.3 C122.9,97.6 130.6,101.9 134.4,103.2" fill="currentColor" style="transform-origin: 130px 106px;" class="octo-arm"></path><path d="M115.0,115.0 C114.9,115.1 118.7,116.5 119.8,115.4 L133.7,101.6 C136.9,99.2 139.9,98.4 142.2,98.6 C133.8,88.0 127.5,74.4 143.8,58.0 C148.5,53.4 154.0,51.2 159.7,51.0 C160.3,49.4 163.2,43.6 171.4,40.1 C171.4,40.1 176.1,42.5 178.8,56.2 C183.1,58.6 187.2,61.8 190.9,65.4 C194.5,69.0 197.7,73.2 200.1,77.6 C213.8,80.2 216.3,84.9 216.3,84.9 C212.7,93.1 206.9,96.0 205.4,96.6 C205.1,102.4 203.0,107.8 198.3,112.5 C181.9,128.9 168.3,122.5 157.7,114.1 C157.9,116.9 156.7,120.9 152.7,124.9 L141.0,136.5 C139.8,137.7 141.6,141.9 141.8,141.8 Z" fill="currentColor" class="octo-body"></path></svg></a>


    <main class="main">
      <div class="main-inner">
        <div class="content-wrap">
          

          <div class="content post posts-expand">
            

    
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="http://example.com/posts/4b9d65e0.html">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.png">
      <meta itemprop="name" content="v5le0n9">
      <meta itemprop="description" content="v5le0n9's garden">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="v5le0n9's garden">
    </span>
      <header class="post-header">
        <h1 class="post-title" itemprop="name headline">
          ç¬¬å…«ä¹è¯¾â€”â€”æ·±å…¥æµ…å‡ºæ¢è®¨è„±å£³ç»†èŠ‚
        </h1>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">å‘è¡¨äº</span>

              <time title="åˆ›å»ºæ—¶é—´ï¼š2022-04-05 09:29:28" itemprop="dateCreated datePublished" datetime="2022-04-05T09:29:28+08:00">2022-04-05</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">æ›´æ–°äº</span>
                <time title="ä¿®æ”¹æ—¶é—´ï¼š2022-04-11 13:25:50" itemprop="dateModified" datetime="2022-04-11T13:25:50+08:00">2022-04-11</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">åˆ†ç±»äº</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/Windows%E9%80%86%E5%90%91/" itemprop="url" rel="index"><span itemprop="name">Windowsé€†å‘</span></a>
                </span>
            </span>

          
            <span class="post-meta-item" title="é˜…è¯»æ¬¡æ•°" id="busuanzi_container_page_pv" style="display: none;">
              <span class="post-meta-item-icon">
                <i class="fa fa-eye"></i>
              </span>
              <span class="post-meta-item-text">é˜…è¯»æ¬¡æ•°ï¼š</span>
              <span id="busuanzi_value_page_pv"></span>
            </span><br>
            <span class="post-meta-item" title="æœ¬æ–‡å­—æ•°">
              <span class="post-meta-item-icon">
                <i class="far fa-file-word"></i>
              </span>
                <span class="post-meta-item-text">æœ¬æ–‡å­—æ•°ï¼š</span>
              <span>6.7k</span>
            </span>
            <span class="post-meta-item" title="é˜…è¯»æ—¶é•¿">
              <span class="post-meta-item-icon">
                <i class="far fa-clock"></i>
              </span>
                <span class="post-meta-item-text">é˜…è¯»æ—¶é•¿ &asymp;</span>
              <span>6 åˆ†é’Ÿ</span>
            </span>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
        <p>åœ¨åšç¬¬äº”å…­è¯¾çš„æ‰“è¡¥ä¸ä½œä¸šæ—¶ï¼Œé‡åˆ°äº†åœ¨ä¸è„±å£³çš„æƒ…å†µä¸‹ä¿®æ”¹ç¨‹åºã€‚åœ¨å¤åˆ¶åˆ°å¯æ‰§è¡Œæ–‡ä»¶æ—¶æç¤ºâ€œæ— æ³•å®šä½æ•°æ®â€ã€‚è¿™æ˜¯å› ä¸ºç¨‹åºåŠ å£³åï¼Œä»£ç æ®µæ˜¾ç¤ºå…¨æ˜¯ç©ºä»£ç ï¼Œæˆ‘ä»¬ä¿®æ”¹ä»£ç æ—¶ï¼Œç³»ç»Ÿæ‰§è¡Œå°†æŸä»£ç 1ä¿®æ”¹ä¸ºæŸä»£ç 2ï¼Œä½†ç³»ç»Ÿåœ¨ä»£ç æ®µæ‰¾ä¸åˆ°æŸä»£ç 1ï¼Œæ‰€ä»¥æç¤ºâ€œæ— æ³•å®šä½æ•°æ®â€ã€‚</p>
<p>ä½†å¦‚æœæˆ‘ä»¬å°†ç¨‹åºè„±å£³äº†ï¼Œå°±å¯åœ¨ç¨‹åºä¸Šéšæ„ä¿®æ”¹ï¼Œæ‰€ä»¥è„±å£³çš„é‡è¦æ€§å°±ä½“ç°å‡ºæ¥äº†ã€‚è„±å£³æ¯ä¸€ç”Ÿï¼Œç ´è§£ç©·ä¸‰ä»£(bushi)ã€‚</p>
<span id="more"></span>
<p><strong>è„±å£³ç»†èŠ‚</strong></p>
<ol>
<li>æ‰¾OEP(åªæ˜¯ä¸‡é‡Œé•¿å¾çš„ç¬¬ä¸€æ­¥)</li>
<li>dump</li>
</ol>
<ul>
<li>æ— æ³•è¯»å–è¿›ç¨‹å†…å­˜:æ¢å·¥å…·(Scyllaä¸é”™)</li>
</ul>
<ol>
<li>ä¿®å¤IAT</li>
</ol>
<ul>
<li>åœ¨æ­¤OEPå…¥å£æ²¡æœ‰æ‰¾åˆ°ä»»ä½•æœ‰ç”¨ä¿¡æ¯:åœ¨ä½ ä½¿ç”¨çš„å·¥å…·é€‰é¡¹ä¸­å–æ¶ˆå‹¾é€‰ä½¿ç”¨æ¥è‡ªç£ç›˜çš„PEæ–‡ä»¶,è¿˜æ˜¯ä¸è¡Œæ¢å·¥å…·(Scylla)</li>
<li>æ— æ•ˆå‡½æ•°<ul>
<li>å‰ªåˆ‡æŒ‡é’ˆ</li>
<li>è·Ÿè¸ªçº§åˆ«1</li>
<li>è·Ÿè¸ªçº§åˆ«3</li>
<li>æ’ä»¶è·Ÿè¸ª</li>
<li>æ‰‹åŠ¨æŸ¥æ‰¾è¾“å…¥è¡¨(åœ¨ODä¸­æ‰¾)</li>
<li>ODè„šæœ¬</li>
</ul>
</li>
</ul>
<p>ç¨‹åºçš„åŠ è½½è¿‡ç¨‹ï¼šç¨‹åºè¢«åŠ è½½è¿›å†…å­˜é‡Œ-&gt;ç³»ç»Ÿæ ¹æ®ç¨‹åºçš„å¯¼å…¥è¡¨ï¼Œå¡«å……ç¨‹åºæ‰€éœ€çš„APIå‡½æ•°åˆ°ç¨‹åºçš„å†…å­˜é‡Œ(IATï¼šå¯¼å…¥åœ°å€è¡¨)ã€‚</p>
<p>å£³ï¼šç¨‹åºçš„å¯¼å…¥è¡¨æ˜¯é™æ€å¯è§çš„ï¼ŒåŒ…å«äº†å¯¼å…¥çš„DLLåç§°å’Œå…¶å¯¼å…¥å‡½æ•°(ç”¨exeinfoå¯çœ‹)ï¼Œæœ‰äº›å£³ä¼šåœ¨åŠ å£³çš„æ—¶å€™æŠŠå¯¼å…¥è¡¨ç»“æ„å–å‡ºï¼Œç„¶åè‡ªè¡ŒåŠ å¯†ï¼Œæˆ–æ”¹å˜ç»“æ„ã€‚è¿™æ—¶ç³»ç»Ÿæ‰¾ä¸åˆ°å¯¼å…¥è¡¨ï¼Œä¹Ÿå°±æ— æ³•ç»™ç¨‹åºå¡«å……æ‰€éœ€çš„APIå‡½æ•°åœ°å€ã€‚åŠ è¿‡å£³çš„ç¨‹åºä¸€å®šæ˜¯å¯ä»¥è¿è¡Œçš„ï¼Œæ‰€ä»¥å¾ˆæ˜æ˜¾è¿™ä¸ªå¡«å……è¿‡ç¨‹è¢«å–ä»£äº†ï¼Œè¿™ä¸ªè¿‡ç¨‹ä¼šåœ¨å£³æ®µå®Œæˆã€‚å¦‚æœè„±å£³æ—¶ç›´æ¥dumpï¼Œç¨‹åºçš„å¯¼å…¥è¡¨ä¹Ÿå°±ä¸åœ¨äº†ï¼ŒIATæ‰€å¡«å……çš„å‡½æ•°åœ°å€æ˜¯å½“å‰ç³»ç»Ÿçš„åœ°å€ï¼Œæ‰€ä»¥è¿™ä¸ªç¨‹åºå¯èƒ½åªèƒ½åœ¨è„±å£³çš„æœºå™¨ä¸Šè¿è¡Œã€‚ä¸ºäº†è§£å†³è¿™ä¸ªé—®é¢˜ï¼Œimport RECå¯¼å…¥IATåœ°å€å€¼ç”Ÿæˆä¸€ä»½å¯¼å…¥è¡¨ï¼Œç„¶åè®©ç¨‹åºä½¿ç”¨æ–°çš„å¯¼å…¥è¡¨ï¼Œç¨‹åºå¯è·¨ç³»ç»Ÿï¼Œåœ¨å„ä¸ªæœºå™¨ä¸Šä¸è¿è¡Œã€‚ä½†æœ‰äº›åŠ å¯†å£³ä¼šä½¿import RECå¤±æ•ˆï¼Œå¯¼è‡´å¯¼å…¥è¡¨æ— æ³•ä¿®å¤ã€‚</p>
<p>å¦‚ä½•ä½¿import RECå¤±æ•ˆï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">æœ¬æ¥çš„å‡½æ•°è°ƒç”¨</span><br><span class="line">call addr_api</span><br><span class="line"></span><br><span class="line">æŸäº›å£³ä¼šä¿®æ”¹ä»£ç </span><br><span class="line">call packspace(packspace:junkcode/æ— æ•ˆæ“ä½œ/vm)</span><br><span class="line">jmp addr_api</span><br></pre></td></tr></table></figure>
<p>ä¹Ÿå°±æ˜¯é—´æ¥è°ƒç”¨APIå‡½æ•°ï¼Œä½¿å·¥å…·æ— æ³•ä¿®å¤å¯¼å…¥è¡¨ã€‚</p>
<p>å¦‚ä½•ä½¿import RECå¤±æ•ˆå˜ä¸ºæœ‰æ•ˆï¼Œå°†é—´æ¥è°ƒç”¨ä¿®æ”¹ä¸ºç›´æ¥è°ƒç”¨ï¼ŒAPIæœ‰å¾ˆå¤šï¼Œæ‰€ä»¥ä¸å¯èƒ½äººå·¥ä¸€ä¸ªä¸ªAPIå‡½æ•°ä¿®æ”¹ï¼Œè€Œæ˜¯ç”¨ODè„šæœ¬ã€‚</p>
<h1 id="1-ç†Ÿæ‚‰ODè„šæœ¬å·¥å…·çš„ä½¿ç”¨"><a href="#1-ç†Ÿæ‚‰ODè„šæœ¬å·¥å…·çš„ä½¿ç”¨" class="headerlink" title="1. ç†Ÿæ‚‰ODè„šæœ¬å·¥å…·çš„ä½¿ç”¨"></a>1. ç†Ÿæ‚‰ODè„šæœ¬å·¥å…·çš„ä½¿ç”¨</h1><p>åœ¨åæ±‡ç¼–çª—å£å³é”®-&gt;Script Functions-&gt;è„šæœ¬è¿è¡Œçª—å£(æˆ–æ’ä»¶-&gt;ODbgScript-&gt;è„šæœ¬è¿è¡Œçª—å£)æ‰“å¼€è„šæœ¬è¿è¡Œçª—å£ã€‚</p>
<p>ï¼ˆ1ï¼‰å³é”®-&gt;è½½å…¥è„šæœ¬ï¼Œå°†å†™å¥½çš„è„šæœ¬æ‰“å¼€è°ƒè¯•è„šæœ¬ã€‚</p>
<p>ï¼ˆ2ï¼‰å³é”®-&gt;è¿è¡Œè„šæœ¬ï¼Œå°†å†™å¥½çš„è„šæœ¬æ‰“å¼€ç›´æ¥è¿è¡Œï¼Œä¸è°ƒè¯•ã€‚</p>
<p>ç¼–å†™ODè„šæœ¬çš„å·¥å…·ï¼š</p>
<p>è„šæœ¬çš„æŒ‡ä»¤ï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">sti 				;F7</span><br><span class="line">sto					;F8</span><br><span class="line">bp åœ°å€	   			;F2</span><br><span class="line">run					;F9</span><br><span class="line">esto				;Shift+F9</span><br><span class="line">gmi eip,CODEBASE	;è·å–ä»£ç æ®µåœ°å€</span><br></pre></td></tr></table></figure>
<p>ç®€å•å†™ä¸€ä¸ªè„šæœ¬å°è¯•ä¸€ä¸‹ï¼Œè„šæœ¬é€šå¸¸ä¸º.txtå’Œ.oscæ ¼å¼ã€‚</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">sti</span><br><span class="line">sti</span><br><span class="line">sti</span><br></pre></td></tr></table></figure>
<p>è½½å…¥è„šæœ¬åï¼Œä¼šè‡ªåŠ¨è¿è¡Œè„šæœ¬çš„ç¬¬1è¡Œï¼ŒæŒ‰Tabé”®æ‰§è¡Œè„šæœ¬çš„ä¸‹ä¸€è¡Œï¼ŒæŒ‰ç©ºæ ¼é”®ç›´æ¥è¿è¡Œè„šæœ¬ã€‚</p>
<img src="/posts/4b9d65e0/%E8%BD%BD%E5%85%A5%E8%84%9A%E6%9C%AC.png" class="" title="è½½å…¥è„šæœ¬">
<h1 id="2-UPXçš„å¤§è¡¨å“¥"><a href="#2-UPXçš„å¤§è¡¨å“¥" class="headerlink" title="2. UPXçš„å¤§è¡¨å“¥"></a>2. UPXçš„å¤§è¡¨å“¥</h1><p>ç”¨æ™®é€šçš„æ–¹æ³•(å•æ­¥è·Ÿè¸ªã€ESPå®šå¾‹ã€ä¸¤æ¬¡å†…å­˜é•œåƒç­‰)å°±èƒ½æ‰¾åˆ°OEPï¼Œå…³é”®åœ¨äºä¿®å¤IATã€‚</p>
<ol>
<li><p>ç”¨importRECè·å–è¾“å…¥è¡¨ï¼Œå‘ç°å…¨éƒ½æ˜¯æ— æ•ˆå‡½æ•°ï¼Œç”¨è·Ÿè¸ªçº§åˆ«1å°±å¯å…¨éƒ¨ä¿®å¤å®Œã€‚</p>
</li>
<li><p>ç¼–å†™ODè„šæœ¬(è¿™èŠ‚è¯¾çš„é‡ç‚¹)ï¼ŒODè„šæœ¬æ˜¯åŸºäºæ±‡ç¼–è¯­è¨€ç¼–å†™çš„ã€‚</p>
</li>
</ol>
<p>å› ä¸ºè¿™ä¸ªæ˜¯UPXå£³ï¼Œæœ‰ä¸€ä¸ªå¤§è·³è½¬è·³åˆ°OEPå¤„ã€‚</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">00457765  - E9 4266FCFF     jmp upxçš„å¤§?0041DDAC</span><br></pre></td></tr></table></figure>
<p>ç¼–å†™åˆ°OEPçš„è„šæœ¬</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">bp 00457765				;åœ¨jmpä¸‹æ–­ç‚¹</span><br><span class="line">run						;F9è¿è¡Œè‡³æ–­ç‚¹å¤„</span><br><span class="line">sti						;F7æ­¥å…¥</span><br><span class="line">MSG &quot;OEPåˆ°äº†&quot;			   ;å¼¹çª—æç¤ºOEPåˆ°äº†</span><br><span class="line">ret						;é€€å‡ºè„šæœ¬</span><br></pre></td></tr></table></figure>
<p>ç›´æ¥è¿è¡Œè„šæœ¬</p>
<img src="/posts/4b9d65e0/%E8%84%9A%E6%9C%AC%E5%BC%B9%E7%AA%97.png" class="" title="è„šæœ¬å¼¹çª—">
<img src="/posts/4b9d65e0/%E8%84%9A%E6%9C%AC%E7%BB%93%E6%9D%9F.png" class="" title="è„šæœ¬ç»“æŸ">
<p>ä½†è¿™ä¸ªè„šæœ¬ä»…é™äºå½“å‰ç¨‹åºä¸”æ— é‡å®šä½(å¦‚æœå½“å‰ç¨‹åºæœ‰é‡å®šä½ï¼Œå–æ¶ˆå®ƒçš„é‡å®šä½å³å¯)ã€‚ç›¸å¯¹æ¥è¯´ï¼ŒESPå®šå¾‹çš„è„šæœ¬æ›´é€šç”¨ã€‚</p>
<p>ESPå®šå¾‹æ˜¯åˆ©ç”¨å †æ ˆå¹³è¡¡æ‰¾OEPçš„æ‰‹æ®µï¼Œé¦–å…ˆè¦æ‰§è¡Œä¸€æ¡å‹æ ˆæŒ‡ä»¤æ¥æ”¹å˜æ ˆã€‚ç­‰ä»¥åå†æ¬¡è¯»å–è¿™ä¸ªæ ˆå†…å®¹çš„æ—¶å€™ï¼Œå°±è¯´æ˜æœ‰æ ˆå¹³è¡¡çš„è¿¹è±¡ï¼Œå¾ˆæœ‰å¯èƒ½æ˜¯æ ˆçš„æ¢å¤ã€‚ä¸€èˆ¬æ¥è¯´ï¼Œå‹ç¼©å£³åªæœ‰ä¸€æ¬¡æ¢å¤ï¼Œç„¶åå°±åˆ°OEPäº†ï¼Œåˆ©ç”¨è¿™ä¸ªç‰¹æ€§æ¥æ‰¾OEPã€‚</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">sti					;æ‰§è¡Œpushad</span><br><span class="line">bphws esp,&quot;r&quot;		;ç»™espä¸‹ç¡¬ä»¶æ–­ç‚¹</span><br><span class="line">run</span><br></pre></td></tr></table></figure>
<p>æ‰§è¡Œå®Œ3è¡Œè„šæœ¬åè¿è¡Œåˆ°<code>00457758</code>ã€‚è¿˜æ²¡åˆ°è¾¾OEPã€‚</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">00457758    8D4424 80       lea eax,dword ptr ss:[esp-0x80]</span><br><span class="line">0045775C    6A 00           push 0x0</span><br><span class="line">0045775E    39C4            cmp esp,eax</span><br><span class="line">00457760  ^ 75 FA           jnz short upxçš„å¤§?0045775C</span><br><span class="line">00457762    83EC 80         sub esp,-0x80</span><br><span class="line">00457765  - E9 4266FCFF     jmp upxçš„å¤§?0041DDAC</span><br></pre></td></tr></table></figure>
<p>å†æ”¹è¿›ä¸€ä¸‹</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">sti					;æ‰§è¡Œpushad</span><br><span class="line">bphws esp,&quot;r&quot;		;ç»™espä¸‹ç¡¬ä»¶æ–­ç‚¹</span><br><span class="line">run</span><br><span class="line">sti</span><br><span class="line">sti</span><br><span class="line">sti					;åˆ°äº†jnz</span><br><span class="line">bp eip</span><br><span class="line">@LOOP:</span><br><span class="line">run</span><br><span class="line">cmp esp,eax</span><br><span class="line">jnz @LOOP</span><br><span class="line">sti</span><br><span class="line">sti</span><br><span class="line">sti					;åˆ°OEP</span><br><span class="line">ret</span><br></pre></td></tr></table></figure>
<p>UPXçš„å£³æ®µä»£ç æ˜¯å·®ä¸å¤šçš„ï¼Œè¿™ä¸ªè„šæœ¬å¯ä»¥ç”¨æ¥æ‰¾è¿™ä¸ªUPXç‰ˆæœ¬æ‰€æœ‰åŠ å£³ç¨‹åºçš„OEPï¼Œè€Œä¸”å…è®¸ç¨‹åºæœ‰é‡å®šä½ã€‚</p>
<p>åˆ°OEPçš„ä¸‹ä¸€æ­¥æ˜¯æ‰¾IATï¼Œé™¤äº†ä¸€äº›ç‰¹åˆ«å˜æ€çš„åŠ å¯†å£³æ¯”å¦‚ï¼šThemidaï¼ŒSEï¼ŒVMProtectï¼Œéƒ½å¯ä»¥æ‰¾æŒ‡ä»¤ä¸º<code>call dword...</code>(FF 15)ï¼Œ<code>jmp dword...</code>(FF 25)æ¥æ‰¾IATã€‚</p>
<img src="/posts/4b9d65e0/%E6%89%BEIAT.png" class="" title="æ‰¾IAT">
<p>å‘ç°æ³¨é‡Šæ˜¯ç©ºçš„ï¼Œåœ¨åæ±‡ç¼–çª—å£çš„é‚£æ¡æŒ‡ä»¤è·Ÿè¿›å»ï¼Œ<code>push APIå‡½æ•°åœ°å€</code></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">00401077    FF15 28204300   call dword ptr ds:[0x432028]</span><br></pre></td></tr></table></figure>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">0096033C    68 88401877     push comctl32.InitCommonControlsEx</span><br><span class="line">00960341    C3              retn</span><br></pre></td></tr></table></figure>
<p>è¿™ä¸¤æ¡æŒ‡ä»¤ç›¸å½“äº<code>jmp InitCommonControlsEx</code>ã€‚å¾ˆæ˜æ˜¾ï¼ŒæŠŠAPIå‡½æ•°è°ƒç”¨æ”¹æˆè‡ªå·±çš„å‡½æ•°ï¼Œç„¶ååœ¨è‡ªå·±çš„å‡½æ•°é‡Œè·³åˆ°çœŸå®çš„APIåœ°å€ã€‚</p>
<p>ä¸€èˆ¬æ¥è¯´ï¼Œé—´æ¥è°ƒç”¨APIå‡½æ•°æœ‰ä¸¤ç§æ–¹æ³•ï¼š</p>
<ul>
<li>åœ¨æŒ‡ä»¤äºŒè¿›åˆ¶ï¼Œç›´æ¥å¸¦æœ‰åœ°å€(push)</li>
<li>æ ¹æ®å½“å‰çš„eipåŠ ä¸ŠæŒ‡ä»¤ä¸­çš„åç§»ç®—å‡ºåœ°å€(jmp)</li>
</ul>
<p>è™½ç„¶å®ƒæ³¨é‡Šæ˜¯ç©ºçš„ï¼Œä½†å¯ä»¥çŸ¥é“IATçš„èµ·å§‹ä½ç½®å‰é¢å…¨æ˜¯ç©ºæ•°æ®ï¼ŒIATç»“æŸæ—¶æ˜¯ä¸ç”¨æˆ·å‡½æ•°åˆ†éš”ã€‚å¯ä»¥æ¨æµ‹IATèµ·å§‹åœ°å€ä¸º<code>432000</code>ï¼Œç»“æŸåœ°å€ä¸º<code>432554</code>ã€‚</p>
<p>ç»§ç»­æ”¹è¿›è„šæœ¬</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line">mov iat_b,00432000</span><br><span class="line">mov iat_e,00432554</span><br><span class="line">sti					;æ‰§è¡Œpushad</span><br><span class="line">bphws esp,&quot;r&quot;		;ç»™espä¸‹ç¡¬ä»¶æ–­ç‚¹</span><br><span class="line">run</span><br><span class="line">sti</span><br><span class="line">sti</span><br><span class="line">sti					;åˆ°äº†jnz</span><br><span class="line">bp eip</span><br><span class="line">@LOOP:</span><br><span class="line">run</span><br><span class="line">cmp esp,eax</span><br><span class="line">jnz @LOOP</span><br><span class="line">sti</span><br><span class="line">sti</span><br><span class="line">sti					;åˆ°OEP</span><br><span class="line">@IAT_LOOP:</span><br><span class="line">mov iat,[iat_b]		;æ¯”å¦‚iat=[432000]</span><br><span class="line">cmp iat,0			;ä¿®æ”¹ä¸äº†ç©ºæ•°æ®ï¼Œæ‰€ä»¥è¦è·³è¿‡</span><br><span class="line">je @NEXT_LOOP</span><br><span class="line">mov api,[iat+1]		;æ¯”å¦‚api=[[432000]+1]=[68 88401877+1]=88401877</span><br><span class="line">mov [iat_b],api		;é‡å»ºiat</span><br><span class="line">@NEXT_LOOP:</span><br><span class="line">add iat_b,4</span><br><span class="line">cmp iat_b,iat_e</span><br><span class="line">jne @IAT_LOOP</span><br><span class="line">ret</span><br></pre></td></tr></table></figure>
<p>è¿è¡Œå®Œè„šæœ¬å†dumpä¸‹æ¥å®Œæˆè„±å£³ã€‚</p>
<p>å¦‚æœä¿®æ”¹ä¸€ä¸ªå°±ä¸ç”¨è„šæœ¬è¿™ä¹ˆéº»çƒ¦ï¼ŒåŒå‡»ä¸‹é¢è¿™æ¡æŒ‡ä»¤å¤åˆ¶APIå‡½æ•°åœ°å€ï¼Œå»åˆ°å¯¹åº”çš„æ•°æ®çª—å£åœ°å€ä¿®æ”¹å…¶æ•°å€¼ï¼Œå³é”®-&gt;ä¿®æ”¹ï¼Œç²˜è´´APIå‡½æ•°åœ°å€ã€‚</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">0096033C    68 88401877     push comctl32.InitCommonControlsEx</span><br></pre></td></tr></table></figure>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">00432028  0096033C</span><br><span class="line">ä¿®æ”¹ä¸º</span><br><span class="line">00432028  77184088  comctl32.InitCommonControlsEx</span><br></pre></td></tr></table></figure>
<p>æ­¤æ—¶å°±å¯çœ‹åˆ°APIå‡½æ•°äº†ã€‚</p>
<h1 id="3-çœŸå‡éš¾è¾¨"><a href="#3-çœŸå‡éš¾è¾¨" class="headerlink" title="3. çœŸå‡éš¾è¾¨"></a>3. çœŸå‡éš¾è¾¨</h1><p>ç”¨å•æ­¥è·Ÿè¸ªã€ä¸¤æ¬¡å†…å­˜é•œåƒç­‰éƒ½èƒ½æ‰¾åˆ°OEP</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">00446021  /.  55            push ebp                                 ;  OEP</span><br><span class="line">00446022  |.  8BEC          mov ebp,esp</span><br><span class="line">00446024  |.  6A FF         push -0x1</span><br><span class="line">00446026  |.  68 70C04600   push çœŸå‡éš¾è¾©.0046C070</span><br><span class="line">0044602B  |.  68 5CA84400   push çœŸå‡éš¾è¾©.0044A85C                       ;  SE å¤„ç†ç¨‹åºå®‰è£…</span><br><span class="line">00446030  |.  64:A1 0000000&gt;mov eax,dword ptr fs:[0]</span><br></pre></td></tr></table></figure>
<p>ä¸ä¼šæ‰¾IATå•Šâ€¦ä¸ä¼šå†™ODè„šæœ¬â€¦</p>
<h1 id="4-è¯¾åä½œä¸š"><a href="#4-è¯¾åä½œä¸š" class="headerlink" title="4. è¯¾åä½œä¸š"></a>4. è¯¾åä½œä¸š</h1><p>æŸ¥å£³æ˜¯telockçš„å£³ï¼Œç”¨æœ€åä¸€æ¬¡å¼‚å¸¸æ³•åˆ°è¾¾OEPï¼Œä¸ä¼šå»ç¬¬ä¸€è¯¾æ‰¾telockå£³è¯¦è§£ã€‚ä¹Ÿå¯ä»¥ä¸‰æ¬¡å†…å­˜é•œåƒ<code>.text</code>-&gt;<code>.rdata</code>-&gt;<code>.text</code>ç›´è¾¾OEPã€‚</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">0045D4F6    55              push ebp</span><br><span class="line">0045D4F7    8BEC            mov ebp,esp</span><br><span class="line">0045D4F9    6A FF           push -0x1</span><br><span class="line">0045D4FB    68 28704800     push ç¬¬å…«ä¹è¯¾.00487028</span><br><span class="line">0045D500    68 D4024600     push ç¬¬å…«ä¹è¯¾.004602D4</span><br></pre></td></tr></table></figure>
<p>æ–¹æ³•ä¸€ï¼šé‡å»ºIATç”¨æ’ä»¶è·Ÿè¸ªï¼Œå‰©ä½™4æ— æ•ˆæŒ‡é’ˆï¼Œç›´æ¥å‰ªåˆ‡ã€‚ç¨‹åºæ­£å¸¸è¿è¡Œã€‚</p>
<p>æ–¹æ³•äºŒï¼šç”¨ODè„šæœ¬ä¿®å¤IATï¼Œèµ·å§‹ä½ç½®ä¸º<code>47D000</code>ï¼Œç»“æŸä½ç½®ä¸º<code>47D6A0</code>ã€‚</p>
<p>ä¸‹é¢è¿™ä¸ªè„šæœ¬å¾ˆå®¹æ˜“çœ‹å¾—æ‡‚</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line">;åˆ°è¾¾OEPæ‰èƒ½ç”¨è¿™ä¸ªè„šæœ¬</span><br><span class="line">mov iat_s, 0047d024</span><br><span class="line">mov iat_e, 0047d16c</span><br><span class="line">@LOOP1:</span><br><span class="line">mov iat,iat_s+663CFE</span><br><span class="line">mov [iat_s],[iat]</span><br><span class="line">add iat_s,4</span><br><span class="line">cmp iat_s,iat_e</span><br><span class="line">jne @LOOP1</span><br><span class="line"> </span><br><span class="line">mov iat_s,0047d16c</span><br><span class="line">mov iat_e,0047D374</span><br><span class="line">@LOOP2:</span><br><span class="line">mov iat,iat_s+644310</span><br><span class="line">mov [iat_s],[iat]</span><br><span class="line">add iat_s,4</span><br><span class="line">cmp iat_s,iat_e</span><br><span class="line">jne @LOOP2</span><br><span class="line"> </span><br><span class="line">mov iat_s,0047D384</span><br><span class="line">mov iat_e,0047D390</span><br><span class="line">@LOOP3:</span><br><span class="line">mov iat,iat_s+6A2CCE</span><br><span class="line">mov [iat_s],[iat]</span><br><span class="line">add iat_s,4</span><br><span class="line">cmp iat_s,iat_e</span><br><span class="line">jne @LOOP3</span><br><span class="line"> </span><br><span class="line">mov iat_s,0047D390</span><br><span class="line">mov iat_e,0047D600</span><br><span class="line">@LOOP4:</span><br><span class="line">mov iat,iat_s+654543</span><br><span class="line">mov [iat_s],[iat]</span><br><span class="line">add iat_s,4</span><br><span class="line">cmp iat_s,iat_e</span><br><span class="line">jne @LOOP4</span><br><span class="line"></span><br><span class="line">MSG &quot;IATä¿®å¤å®Œæˆï¼&quot;</span><br><span class="line">ret</span><br></pre></td></tr></table></figure>
<p>æ‹¿@LOOP1æ¥è¯´ï¼Œ<code>0047d024</code>çš„æ•°å€¼ä¸º<code>00AE0000</code>ï¼ŒAlt+Mè¿›å…¥æ‰¾åœ°å€ä¸º<code>00AE0000</code>çš„æ•°æ®æ®µï¼Œå¼€å¤´æ˜¯ä¸€å¤§æ®µæ‚ä¹±çš„æ•°æ®ï¼Œåé¢æ˜¯ç©ºæ•°æ®ï¼Œç´§æ¥ç€åˆä¸€æ®µæœ‰è§„å¾‹çš„æ•°æ®ï¼Œå†æ¥ç€ç©ºæ•°æ®ã€‚è¿™æ®µæœ‰è§„å¾‹çš„æ•°æ®éƒ½æ˜¯ä»¥<code>77</code>å¼€å¤´çš„ï¼ŒçŒœæµ‹æ˜¯dllé¢†ç©ºçš„APIå‡½æ•°åœ°å€ã€‚ è€Œ<code>0047d024</code>ä¸<code>00AE0D22</code>ç›¸å·®<code>663CFE</code>ï¼Œæ‰€ä»¥è¦åŠ ä¸Šåç§»<code>663CFE</code>å³å¯å¾—åˆ°APIå‡½æ•°åœ°å€ã€‚@LOOP2åˆ°@LOOP4éƒ½åŒç†ã€‚</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line">00AE0D20   00 00 C0 6D F0 77 56 D2 EF 77 1D AF EF 77 FF 82  ..çºŒé¥‚Vç»wîˆ¤wï£µ</span><br><span class="line">00AE0D30   EF 77 17 6D F2 77 F1 7C EF 77 74 78 EF 77 D9 B4  é£›mé¨±é§–é£›txé£›ä¿…</span><br><span class="line">00AE0D40   EF 77 71 5A EF 77 6D E4 EF 77 EF 61 EF 77 E0 5F  é£›qZé£›mæ»¹wé¢½é£›éƒ·</span><br><span class="line">00AE0D50   EF 77 70 5B EF 77 79 6F EF 77 3D 99 EF 77 BE 99  é£›p[é£›yoé£›=æ¬™wç·³</span><br><span class="line">00AE0D60   EF 77 18 89 EF 77 1A E8 EF 77 A0 C7 F1 77 BB 9D  é£›å¤›wæ ¾wçŠŒé§‘ç²·</span><br><span class="line">00AE0D70   EF 77 86 77 EF 77 77 DE EF 77 0F 84 EF 77 78 ED  é£›å”šé£›wæwå‹¶wx</span><br><span class="line">00AE0D80   EF 77 A5 61 EF 77 C1 61 EF 77 2A EB EF 77 D1 86  é£›î™§é£›ç¾‡é£›*è…¼wè¤‘</span><br><span class="line">00AE0D90   EF 77 41 9D EF 77 EE BB EF 77 F3 D7 EF 77 83 9A  é£›Aæ¿“wç½¨é£›ç¬é£›å„¦</span><br><span class="line">00AE0DA0   EF 77 15 90 EF 77 B8 D9 F1 77 3A 71 F0 77 3D 8D  é£›æ„¶wçº²é§‘:qé¥‚=</span><br><span class="line">00AE0DB0   EF 77 0A 70 EF 77 31 DB F0 77 6E F3 F0 77 D2 34  é£›.pé£›1å§wnç®´w?</span><br><span class="line">00AE0DC0   F0 77 5A 3F F2 77 5E EA EF 77 84 8E EF 77 65 34  é¥‚Z?é¨±^è§‘wå‰®é£›e4</span><br><span class="line">00AE0DD0   F0 77 D8 8E EF 77 C1 DD F0 77 60 BE EF 77 F2 4E  é¥‚è²›é£›å‡›é¥‚`æ’…wé¨ˆ</span><br><span class="line">00AE0DE0   F2 77 38 67 F2 77 D8 D3 F0 77 58 D3 F0 77 5F 6E  é¨±8gé¨±èµœé¥‚Xç¾½w_n</span><br><span class="line">00AE0DF0   EF 77 60 83 EF 77 23 D3 EF 77 FA 6B EF 77 A0 7A  é£›`å†¿w#è¯­wé·é£›çˆ–</span><br><span class="line">00AE0E00   EF 77 D6 6A EF 77 D1 AB EF 77 D3 B8 EF 77 36 86  é£›è¬é£›å‹‹é£›ç—ˆé£›6</span><br><span class="line">00AE0E10   EF 77 7A D8 EF 77 D7 D8 F1 77 E3 71 F0 77 81 BE  é£›zä»«wæ£•é§‘é‰¸é¥‚ä¼¨</span><br><span class="line">00AE0E20   EF 77 4C 7B EF 77 BE 95 EF 77 2C D7 EF 77 77 06  é£›L&#123;é£›ç·¯é£›,ç½ªww</span><br><span class="line">00AE0E30   F0 77 DB 5E EF 77 01 7C EF 77 79 7C EF 77 BA 92  é¥‚è¸é£›|é£›y|é£›ç°°</span><br><span class="line">00AE0E40   EF 77 B7 E8 EF 77 29 5E EF 77 EA C3 F0 77 89 63  é£›ç–¯é£›)^é£›æ˜é¥‚å¡©</span><br><span class="line">00AE0E50   F2 77 40 97 EF 77 06 98 EF 77 77 5D EF 77 A1 6A  é¨±@æ¥‹wæ©ˆww]é£›î“°</span><br><span class="line">00AE0E60   EF 77 A1 DD EF 77 2D A4 EF 77 00 00 00 00 00 00  é£›â‰¥é£›-ã‚w......</span><br><span class="line">00AE0E70   00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00  ................</span><br></pre></td></tr></table></figure>
<p>ç”¨æœ€åä¸€æ¬¡å¼‚å¸¸æ³•åˆ°OEPå’Œä¿®å¤IATï¼Œæ¥è‡ªè®ºå›è‹ç´«æ–¹ç’‡çš„è„šæœ¬ï¼š(é«˜çº§ï¼Œçœ‹ä¸æ‡‚å°±æ˜¯äº†)</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br></pre></td><td class="code"><pre><span class="line">var iat_b         ;iatèµ·å§‹ä½ç½®</span><br><span class="line">var iat_e         ;iatç»“æŸä½ç½®</span><br><span class="line">var tmp           ;ä¸´æ—¶ä¸­è½¬</span><br><span class="line">var string        ;å‚¨å­˜ä»£ç æ®µè‡ªåŠ¨è·Ÿè¸ªå‘½ä»¤</span><br><span class="line">var oldesp        ;espå¤‡ä»½</span><br><span class="line">var oldeip        ;eipå¤‡ä»½</span><br><span class="line">var codebegin     ;ä»£ç æ®µèµ·å§‹åœ°å€</span><br><span class="line">var codesize      ;ä»£ç æ®µå¤§å°</span><br><span class="line"> </span><br><span class="line">gmi eip,CODEBASE             ;è·å–ä»£ç æ®µåœ°å€</span><br><span class="line">mov codebegin,$RESULT</span><br><span class="line">gmi eip,CODESIZE             ;è·å–ä»£ç æ®µå¤§å°</span><br><span class="line">mov codesize,$RESULT</span><br><span class="line">add codebegin,codesize       ;å¾—åˆ°æœ«å°¾åœ°å€</span><br><span class="line">mov string,&quot;eip &lt; &quot;          ;æ„å»ºè‡ªåŠ¨è·Ÿè¸ªæŒ‡ä»¤</span><br><span class="line">add string,codebegin</span><br><span class="line">msg &quot;è¯·å–æ¶ˆæ‰€æœ‰çš„å¿½ç•¥å¼‚å¸¸&quot;	;StrongODä¸­çš„skip some exceptionsè¦å‹¾é€‰</span><br><span class="line">ESTO</span><br><span class="line">ESTO</span><br><span class="line">ESTO</span><br><span class="line">ESTO</span><br><span class="line">ESTO</span><br><span class="line">ESTO</span><br><span class="line">ESTO                      ;æœ€åä¸€æ¬¡å¼‚å¸¸æ³•</span><br><span class="line">bphws [esp+4],&quot;x&quot;         ;Sehåœ°å€ä¸‹ç¡¬ä»¶æ–­ç‚¹</span><br><span class="line">ESTO                      ;Shift+F9</span><br><span class="line">bphwcall                  ;æ¸…é™¤æ‰€æœ‰ç¡¬ä»¶æ–­ç‚¹</span><br><span class="line">TICND string              ;TICND &quot;eip &lt; 47d000&quot;       ;tc eip&lt;47d000</span><br><span class="line">cmt eip,&quot;ç¨‹åºå…¥å£ç‚¹&quot;</span><br><span class="line">msg &quot;æ‰¾åˆ°å…¥å£ç‚¹&quot;</span><br><span class="line">;IATä¿®å¤</span><br><span class="line">mov iat_b,0047D000</span><br><span class="line">mov iat_e,0047D6A0</span><br><span class="line">mov oldesp,esp           ;å¤‡ä»½espï¼Œeip</span><br><span class="line">mov oldeip,eip</span><br><span class="line">@ILoop:</span><br><span class="line">mov tmp,[iat_b]          ;tmp=åŸå§‹iatè¡¨å€¼</span><br><span class="line">cmp tmp,10000000</span><br><span class="line">ja @Next                 ;è‹¥å¤§äº10000000å°±æ¢ä¸‹ä¸€ä¸ª</span><br><span class="line">cmp tmp,00400000</span><br><span class="line">ja @Start                ;è‹¥å¤§äº00400000å°±ç»§ç»­è¿è¡Œ</span><br><span class="line">cmp tmp,0</span><br><span class="line">jz @Next                 ;ç­‰äº0å°±æ¢ä¸‹ä¸€ä¸ª</span><br><span class="line">@Start:</span><br><span class="line">mov eip,tmp          	;è®¾å®šeip</span><br><span class="line">mov esp,oldesp       	;æ¢å¤esp</span><br><span class="line">rtr                   	;è¿è¡Œåˆ°è¿”å›</span><br><span class="line">mov [iat_b],[esp]      	;ä¿®å¤IAT</span><br><span class="line">@Next:</span><br><span class="line">add iat_b,4           	;ä¸‹ä¸€ä¸ªiat</span><br><span class="line">cmp iat_b,iat_e       	;åˆ¤æ–­æ˜¯å¦ç»“æŸ</span><br><span class="line">jnz @ILoop</span><br><span class="line">mov eip,oldeip        	;æ¢å¤eipï¼Œesp</span><br><span class="line">mov esp,oldesp</span><br><span class="line">ret</span><br></pre></td></tr></table></figure>

    </div>

    
    
    
        <div class="reward-container">
  <div></div>
  <button onclick="var qr = document.getElementById('qr'); qr.style.display = (qr.style.display === 'none') ? 'block' : 'none';">
    æ‰“èµ
  </button>
  <div id="qr" style="display: none;">
      
      <div style="display: inline-block;">
        <img src="/images/wechatpay.jpg" alt="v5le0n9 å¾®ä¿¡æ”¯ä»˜">
        <p>å¾®ä¿¡æ”¯ä»˜</p>
      </div>
      
      <div style="display: inline-block;">
        <img src="/images/alipay.jpg" alt="v5le0n9 æ”¯ä»˜å®">
        <p>æ”¯ä»˜å®</p>
      </div>

  </div>
</div>


      <footer class="post-footer">
          
          <div class="post-tags">
              <a href="/tags/OllyDbg/" rel="tag"><i class="fa fa-tag"></i> OllyDbg</a>
              <a href="/tags/%E5%90%BE%E7%88%B1%E7%A0%B4%E8%A7%A3%E5%9F%B9%E8%AE%AD/" rel="tag"><i class="fa fa-tag"></i> å¾çˆ±ç ´è§£åŸ¹è®­</a>
          </div>

        


        
    <div class="post-nav">
      <div class="post-nav-item">
    <a href="/posts/bb44dc0.html" rel="prev" title="ç¬¬äº”å…­è¯¾â€”â€”è§£é™¤ç¨‹åºé‡å¯éªŒè¯ï¼Œç¨‹åºæ‰“è¡¥ä¸">
      <i class="fa fa-chevron-left"></i> ç¬¬äº”å…­è¯¾â€”â€”è§£é™¤ç¨‹åºé‡å¯éªŒè¯ï¼Œç¨‹åºæ‰“è¡¥ä¸
    </a></div>
      <div class="post-nav-item">
    <a href="/posts/efe98763.html" rel="next" title="ç¬¬åè¯¾â€”â€”x64å¹³å°è„±å£³ä¸ç ´è§£å®æˆ˜">
      ç¬¬åè¯¾â€”â€”x64å¹³å°è„±å£³ä¸ç ´è§£å®æˆ˜ <i class="fa fa-chevron-right"></i>
    </a></div>
    </div>
      </footer>
    
  </article>
  
  
  



          </div>
          
    <div class="comments" id="gitalk-container"></div>

<script>
  window.addEventListener('tabs:register', () => {
    let { activeClass } = CONFIG.comments;
    if (CONFIG.comments.storage) {
      activeClass = localStorage.getItem('comments_active') || activeClass;
    }
    if (activeClass) {
      let activeTab = document.querySelector(`a[href="#comment-${activeClass}"]`);
      if (activeTab) {
        activeTab.click();
      }
    }
  });
  if (CONFIG.comments.storage) {
    window.addEventListener('tabs:click', event => {
      if (!event.target.matches('.tabs-comment .tab-content .tab-pane')) return;
      let commentClass = event.target.classList[1];
      localStorage.setItem('comments_active', commentClass);
    });
  }
</script>

        </div>
          
  
  <div class="toggle sidebar-toggle">
    <span class="toggle-line toggle-line-first"></span>
    <span class="toggle-line toggle-line-middle"></span>
    <span class="toggle-line toggle-line-last"></span>
  </div>

  <aside class="sidebar">
    <div class="sidebar-inner">

      <ul class="sidebar-nav motion-element">
        <li class="sidebar-nav-toc">
          æ–‡ç« ç›®å½•
        </li>
        <li class="sidebar-nav-overview">
          ç«™ç‚¹æ¦‚è§ˆ
        </li>
      </ul>

      <!--noindex-->
      <div class="post-toc-wrap sidebar-panel">
          <div class="post-toc motion-element"><ol class="nav"><li class="nav-item nav-level-1"><a class="nav-link" href="#1-%E7%86%9F%E6%82%89OD%E8%84%9A%E6%9C%AC%E5%B7%A5%E5%85%B7%E7%9A%84%E4%BD%BF%E7%94%A8"><span class="nav-text">1. ç†Ÿæ‚‰ODè„šæœ¬å·¥å…·çš„ä½¿ç”¨</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#2-UPX%E7%9A%84%E5%A4%A7%E8%A1%A8%E5%93%A5"><span class="nav-text">2. UPXçš„å¤§è¡¨å“¥</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#3-%E7%9C%9F%E5%81%87%E9%9A%BE%E8%BE%A8"><span class="nav-text">3. çœŸå‡éš¾è¾¨</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#4-%E8%AF%BE%E5%90%8E%E4%BD%9C%E4%B8%9A"><span class="nav-text">4. è¯¾åä½œä¸š</span></a></li></ol></div>
      </div>
      <!--/noindex-->

      <div class="site-overview-wrap sidebar-panel">
        <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
    <img class="site-author-image" itemprop="image" alt="v5le0n9"
      src="/images/avatar.png">
  <p class="site-author-name" itemprop="name">v5le0n9</p>
  <div class="site-description" itemprop="description">v5le0n9's garden</div>
</div>
<div class="site-state-wrap motion-element">
  <nav class="site-state">
      <div class="site-state-item site-state-posts">
          <a href="/archives/">
        
          <span class="site-state-item-count">43</span>
          <span class="site-state-item-name">æ—¥å¿—</span>
        </a>
      </div>
      <div class="site-state-item site-state-categories">
            <a href="/categories/">
          
        <span class="site-state-item-count">9</span>
        <span class="site-state-item-name">åˆ†ç±»</span></a>
      </div>
      <div class="site-state-item site-state-tags">
            <a href="/tags/">
          
        <span class="site-state-item-count">18</span>
        <span class="site-state-item-name">æ ‡ç­¾</span></a>
      </div>
  </nav>
</div>
  <div class="links-of-author motion-element">
      <span class="links-of-author-item">
        <a href="https://blog.csdn.net/Leong_Vinson" title="CSDN â†’ https:&#x2F;&#x2F;blog.csdn.net&#x2F;Leong_Vinson" rel="noopener" target="_blank"><i class="fab fa-cuttlefish fa-fw"></i>CSDN</a>
      </span>
      <span class="links-of-author-item">
        <a href="https://github.com/v5le0n9" title="GitHub â†’ https:&#x2F;&#x2F;github.com&#x2F;v5le0n9" rel="noopener" target="_blank"><i class="fab fa-github fa-fw"></i>GitHub</a>
      </span>
      <span class="links-of-author-item">
        <a href="mailto:v5le0n9@163.com" title="E-Mail â†’ mailto:v5le0n9@163.com" rel="noopener" target="_blank"><i class="fa fa-envelope fa-fw"></i>E-Mail</a>
      </span>
  </div>



      </div>
        <div class="back-to-top motion-element">
          <i class="fa fa-arrow-up"></i>
          <span>0%</span>
        </div>

    </div>
  </aside>
  <div id="sidebar-dimmer"></div>


      </div>
    </main>

    <footer class="footer">
      <div class="footer-inner">
        

        

<div class="copyright">
  
  &copy; 
  <span itemprop="copyrightYear">2022</span>
  <span class="with-love">
    <i class="fa fa-heart"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">v5le0n9</span>
    <span class="post-meta-divider">|</span>
    <span class="post-meta-item-icon">
      <i class="fa fa-chart-area"></i>
    </span>
    <span title="ç«™ç‚¹æ€»å­—æ•°">902k</span>
    <span class="post-meta-divider">|</span>
    <span class="post-meta-item-icon">
      <i class="fa fa-coffee"></i>
    </span>
    <span title="ç«™ç‚¹é˜…è¯»æ—¶é•¿">13:40</span>
</div>

        
<div class="busuanzi-count">
  <script async src="https://busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script>
    <span class="post-meta-item" id="busuanzi_container_site_uv" style="display: none;">
      <span class="post-meta-item-icon">
        <i class="fa fa-user"></i>
      </span>
      <span class="site-uv" title="æ€»è®¿å®¢é‡">
        <span id="busuanzi_value_site_uv"></span>
      </span>
    </span>
    <span class="post-meta-divider">|</span>
    <span class="post-meta-item" id="busuanzi_container_site_pv" style="display: none;">
      <span class="post-meta-item-icon">
        <i class="fa fa-eye"></i>
      </span>
      <span class="site-pv" title="æ€»è®¿é—®é‡">
        <span id="busuanzi_value_site_pv"></span>
      </span>
    </span>
</div>








      </div>
    </footer>
  </div>

  
  <script src="/lib/anime.min.js"></script>
  <script src="/lib/velocity/velocity.min.js"></script>
  <script src="/lib/velocity/velocity.ui.min.js"></script>

<script src="/js/utils.js"></script>

<script src="/js/motion.js"></script>


<script src="/js/schemes/pisces.js"></script>


<script src="/js/next-boot.js"></script>

<script src="/js/bookmark.js"></script>




  




  
<script src="/js/local-search.js"></script>













  

  
      

<script>
  if (typeof MathJax === 'undefined') {
    window.MathJax = {
      loader: {
          load: ['[tex]/mhchem'],
        source: {
          '[tex]/amsCd': '[tex]/amscd',
          '[tex]/AMScd': '[tex]/amscd'
        }
      },
      tex: {
        inlineMath: {'[+]': [['$', '$']]},
          packages: {'[+]': ['mhchem']},
        tags: 'ams'
      },
      options: {
        renderActions: {
          findScript: [10, doc => {
            document.querySelectorAll('script[type^="math/tex"]').forEach(node => {
              const display = !!node.type.match(/; *mode=display/);
              const math = new doc.options.MathItem(node.textContent, doc.inputJax[0], display);
              const text = document.createTextNode('');
              node.parentNode.replaceChild(text, node);
              math.start = {node: text, delim: '', n: 0};
              math.end = {node: text, delim: '', n: 0};
              doc.math.push(math);
            });
          }, '', false],
          insertedScript: [200, () => {
            document.querySelectorAll('mjx-container').forEach(node => {
              let target = node.parentNode;
              if (target.nodeName.toLowerCase() === 'li') {
                target.parentNode.classList.add('has-jax');
              }
            });
          }, '', false]
        }
      }
    };
    (function () {
      var script = document.createElement('script');
      script.src = '//cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js';
      script.defer = true;
      document.head.appendChild(script);
    })();
  } else {
    MathJax.startup.document.state(0);
    MathJax.texReset();
    MathJax.typeset();
  }
</script>

    

  

<link rel="stylesheet" href="//cdn.jsdelivr.net/npm/gitalk@1/dist/gitalk.min.css">

<script>
NexT.utils.loadComments(document.querySelector('#gitalk-container'), () => {
  NexT.utils.getScript('//cdn.jsdelivr.net/npm/gitalk@1/dist/gitalk.min.js', () => {
    var gitalk = new Gitalk({
      clientID    : '7c58e80079a2457b610d',
      clientSecret: 'fc16b1b0fdfb278016ebe41c20f3743c3c927466',
      repo        : 'comments.github.io',
      owner       : 'v5le0n9',
      admin       : ['v5le0n9'],
      id          : '064eb67be3572c5b41cfd6837adfd95b',
        language: 'zh-CN',
      distractionFreeMode: true
    });
    gitalk.render('gitalk-container');
  }, window.Gitalk);
});
</script>

</body>
</html>
